# 22/06/20

<aside>
ğŸ’¡ MVC íŒ¨í„´ ì´í•´í•˜ê¸°

</aside>

# To_do_listâœ”ï¸



- [x]  MVC 1í¸_ ~ ì™„ê°•
- [x]  ë…¸ì…˜ ì •ë¦¬
- [x]  TIL



# íšŒê³ ğŸ¤”

# [í•™ìŠµë‚´ìš©]



## ìŠ¤í”„ë§ MVC ì „ì²´ êµ¬ì¡°

### ì§ì ‘ ë§Œë“  MVC í”„ë ˆì„ì›Œí¬ & ìŠ¤í”„ë§ MVC

**ì§ì ‘ ë§Œë“  MVC í”„ë ˆì„ì›Œí¬ êµ¬ì¡°**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-22 á„‹á…©á„’á…® 12.45.39.png](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/414f9b3e-6dd5-43c8-b616-e146445719d3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-22_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.45.39.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220630%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220630T023239Z&X-Amz-Expires=86400&X-Amz-Signature=882c29736ce91a49e1bbdebe0eb27a34e90870783e0dd42820afc7c660aa4d91&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA%25202022-06-22%2520%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE%252012.45.39.png%22&x-id=GetObject)

**Spring MVC êµ¬ì¡°**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-06-22 á„‹á…©á„’á…® 12.46.06.png](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/e1260372-3f8c-41f3-83a7-cf46a3ea2506/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-06-22_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.46.06.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220630%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220630T023253Z&X-Amz-Expires=86400&X-Amz-Signature=afe29e1aba2e30c301591a7a069f34aa806b7f1f1dc2f887f45b2859ce043720&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA%25202022-06-22%2520%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE%252012.46.06.png%22&x-id=GetObject)

### **ë™ì‘ ìˆœì„œ**

1. **í•¸ë“¤ëŸ¬ ì¡°íšŒ**: í•¸ë“¤ëŸ¬ ë§¤í•‘ì„ í†µí•´ ìš”ì²­ URLì— ë§¤í•‘ëœ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ì¡°íšŒí•œë‹¤.
2. **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì¡°íšŒ**: í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ì¡°íšŒí•œë‹¤.
3. **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì‹¤í–‰**: í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ ì‹¤í–‰í•œë‹¤.
4.  **í•¸ë“¤ëŸ¬ ì‹¤í–‰**: í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°€ ì‹¤ì œ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.
5. **ModelAndView ë°˜í™˜**: í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ëŠ” í•¸ë“¤ëŸ¬ê°€ ë°˜í™˜í•˜ëŠ” ì •ë³´ë¥¼ ModelAndViewë¡œ **ë³€í™˜**í•´ì„œ
ë°˜í™˜í•œë‹¤.
6. **viewResolver í˜¸ì¶œ**: ë·° ë¦¬ì¡¸ë²„ë¥¼ ì°¾ê³  ì‹¤í–‰í•œë‹¤.
- JSPì˜ ê²½ìš°: InternalResourceViewResolver ê°€ ìë™ ë“±ë¡ë˜ê³ , ì‚¬ìš©ëœë‹¤.
7. **Viewë°˜í™˜**:ë·°ë¦¬ì¡¸ë²„ëŠ”ë·°ì˜ë…¼ë¦¬ì´ë¦„ì„ë¬¼ë¦¬ì´ë¦„ìœ¼ë¡œë°”ê¾¸ê³ ,ë Œë”ë§ì—­í• ì„ë‹´ë‹¹í•˜ëŠ”ë·°ê°ì²´ë¥¼
ë°˜í™˜í•œë‹¤.
- JSPì˜ ê²½ìš° InternalResourceView(JstlView) ë¥¼ ë°˜í™˜í•˜ëŠ”ë°, ë‚´ë¶€ì— forward() ë¡œì§ì´ ìˆë‹¤.
8. **ë·°ë Œë”ë§**:ë·°ë¥¼í†µí•´ì„œë·°ë¥¼ë Œë”ë§í•œë‹¤.

## **ì§ì ‘ ë§Œë“  í”„ë ˆì„ì›Œí¬ ìŠ¤í”„ë§ MVC ë¹„êµ**

- FrontController â¡ï¸Â DispatcherServlet
- handlerMappingMap â¡ï¸Â HandlerMapping
- MyHandlerAdapter â¡ï¸ HandlerAdapter
- ModelView â¡ï¸ ModelAndView
- viewResolver â¡ï¸ ViewResolver
- MyView â¡ï¸ View

## **DispatcherServlet êµ¬ì¡° ì‚´í´ë³´ê¸°**

```java
org.springframework.web.servlet.DispatcherServlet
```

- ìŠ¤í”„ë§ MVCë„ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤.
- ìŠ¤í”„ë§ MVCì˜ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë°”ë¡œ ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿(DispatcherServlet)ì´ë‹¤.
- ê·¸ë¦¬ê³  ì´ **ë””ìŠ¤íŒ¨ì²˜ ì„œë¸”ë¦¿ì´ ë°”ë¡œ ìŠ¤í”„ë§ MVCì˜ í•µì‹¬**ì´ë‹¤.

## **DispacherServlet ì„œë¸”ë¦¿ ë“±ë¡**

- `DispacherServlet` ë„ ë¶€ëª¨ í´ë˜ìŠ¤ì—ì„œ `HttpServlet` ì„ ìƒì† ë°›ì•„ì„œ ì‚¬ìš©í•˜ê³ , ì„œë¸”ë¦¿ìœ¼ë¡œ ë™ì‘í•œë‹¤.
    - DispatcherServlet â¡ï¸Â FrameworkServlet â¡ï¸ HttpServletBean â¡ï¸Â HttpServlet
- ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” `DispacherServlet` ì„ ì„œë¸”ë¦¿ìœ¼ë¡œ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ë©´ì„œ **ëª¨ë“  ê²½ë¡œ**`( urlPatterns="/" )`ì— ëŒ€í•´ì„œ ë§¤í•‘í•œë‹¤.
    - ì°¸ê³ : ë” ìì„¸í•œ ê²½ë¡œê°€ ìš°ì„ ìˆœìœ„ê°€ ë†’ë‹¤. ê·¸ë˜ì„œ ê¸°ì¡´ì— ë“±ë¡í•œ ì„œë¸”ë¦¿ë„ í•¨ê»˜ ë™ì‘í•œë‹¤.
    

## ìš”ì²­ íë¦„

- ì„œë¸”ë¦¿ì´ í˜¸ì¶œë˜ë©´ `HttpServlet` ì´ ì œê³µí•˜ëŠ” `serivce()` ê°€ í˜¸ì¶œëœë‹¤.
- ìŠ¤í”„ë§ MVCëŠ” `DispatcherServlet` ì˜ ë¶€ëª¨ì¸ `FrameworkServlet` ì—ì„œ `service()` ë¥¼ ì˜¤ë²„ë¼ì´ë“œ
í•´ë‘ì—ˆë‹¤.
- `FrameworkServlet.service()` ë¥¼ ì‹œì‘ìœ¼ë¡œ ì—¬ëŸ¬ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ì„œ
`DispacherServlet.doDispatch()` ê°€ í˜¸ì¶œëœë‹¤.

**DispacherServlet.doDispatch()**

```java
protected void **doDispatch**(HttpServletRequest request, HttpServletResponse
  response) throws Exception {

    HttpServletRequest processedRequest = request;
    HandlerExecutionChain mappedHandler = null;
    ModelAndView mv = null;

// 1. í•¸ë“¤ëŸ¬ ì¡°íšŒ
mappedHandler = getHandler(processedRequest); 
if (mappedHandler == null) {
        noHandlerFound(processedRequest, response);
				return; 
}

//2.í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì¡°íšŒ-í•¸ë“¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì–´ëŒ‘í„°
HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());

// 3. í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì‹¤í–‰ -> 4. í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ë¥¼ í†µí•´ í•¸ë“¤ëŸ¬ ì‹¤í–‰ -> 5. ModelAndView ë°˜í™˜ 
mv = ha.handle(processedRequest, response, mappedHandler.getHandler());

  processDispatchResult(processedRequest, response, mappedHandler, mv,
  dispatchException);

}

  private void processDispatchResult(HttpServletRequest request,
  HttpServletResponse response, HandlerExecutionChain mappedHandler, ModelAndView
  mv, Exception exception) throws Exception {
         
 // ë·° ë Œë”ë§ í˜¸ì¶œ
	render(mv, request, response);

 }

  protected void render(ModelAndView mv, HttpServletRequest request,
  HttpServletResponse response) throws Exception {

    View view;
		String viewName = mv.getViewName(); 

	//6. ë·° ë¦¬ì¡¸ë²„ë¥¼ í†µí•´ì„œ ë·° ì°¾ê¸°,7.View ë°˜í™˜
    view = resolveViewName(viewName, mv.getModelInternal(), locale, request);

	// 8. ë·° ë Œë”ë§
    view.render(mv.getModelInternal(), request, response);
  }
```

## ìŠ¤í”„ë§ MVC - ì‹œì‘í•˜ê¸°

### **@RequestMapping**

ìŠ¤í”„ë§ì€ ì• ë…¸í…Œì´ì…˜ì„ í™œìš©í•œ ë§¤ìš° ìœ ì—°í•˜ê³ , ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì—ˆëŠ”ë° ì´ê²ƒì´ ë°”ë¡œ
@RequestMapping ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì´ë‹¤. ë‹¤ë“¤ í•œë²ˆì¯¤ ì‚¬ìš©í•´ë³´ì•˜ì„ ê²ƒì´ë‹¤.
ì—¬ë‹´ì´ì§€ë§Œ ê³¼ê±°ì—ëŠ” ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ê°€ MVC ë¶€ë¶„ì´ ì•½í•´ì„œ ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë”ë¼ë„ MVC ì›¹ ê¸°ìˆ ì€
ìŠ¤íŠ¸ëŸ¿ì¸  ê°™ì€ ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í–ˆì—ˆë‹¤. ê·¸ëŸ°ë° @RequestMapping ê¸°ë°˜ì˜ ì• ë…¸í…Œì´ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ê°€
ë“±ì¥í•˜ë©´ì„œ, MVC ë¶€ë¶„ë„ ìŠ¤í”„ë§ì˜ ì™„ìŠ¹ìœ¼ë¡œ ëì´ ë‚¬ë‹¤.

**@RequestMapping**

- `RequestMappingHandlerMapping`
- `RequestMappingHandlerAdapter`

ì•ì„œ ë³´ì•˜ë“¯ì´ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ëŠ” `RequestMappingHandlerMapping` ,
`RequestMappingHandlerAdapter` ì´ë‹¤.
@RequestMapping ì˜ ì•ê¸€ìë¥¼ ë”°ì„œ ë§Œë“  ì´ë¦„ì¸ë°, ì´ê²ƒì´ ë°”ë¡œ ì§€ê¸ˆ ìŠ¤í”„ë§ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ”
ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì§€ì›í•˜ëŠ” í•¸ë“¤ëŸ¬ ë§¤í•‘ê³¼ ì–´ëŒ‘í„°ì´ë‹¤. **ì‹¤ë¬´ì—ì„œëŠ” 99.9% ì´ ë°©ì‹ì˜
ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‚¬ìš©**í•œë‹¤.

## ìŠ¤í”„ë§ MVC - ì‹¤ìš©ì ì¸ ë°©ì‹

```java
/**
* v3
* Model ë„ì…
* ViewName ì§ì ‘ ë°˜í™˜
       
 * @RequestParam ì‚¬ìš©
* @RequestMapping -> @GetMapping, @PostMapping */
  @Controller
  @RequestMapping("/springmvc/v3/members")

  public class SpringMemberControllerV3 {

      private MemberRepository memberRepository = MemberRepository.getInstance();

      @GetMapping("/new-form")
      public String newForm() {
          return "new-form";
      }

      @PostMapping("/save")
      public String save(
              @RequestParam("username") String username,
              @RequestParam("age") int age,
              Model model) {

          Member member = new Member(username, age);
          memberRepository.save(member);

          model.addAttribute("member", member);
          return "save-result";
      }

      @GetMapping
      public String members(Model model) {
          List<Member> members = memberRepository.findAll();
          model.addAttribute("members", members);
          return "members";
	} 
}
```

### **Model íŒŒë¼ë¯¸í„°**

- `save()` , `members()` ë¥¼ ë³´ë©´ Modelì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- ìŠ¤í”„ë§ MVCë„ ì´ëŸ° í¸ì˜ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

### **ViewName ì§ì ‘ ë°˜í™˜**

- ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.

### **@RequestParam ì‚¬ìš©**

- ìŠ¤í”„ë§ì€ HTTP ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ `@RequestParam` ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤.
- `@RequestParam("username")` ì€ r`equest.getParameter("username")` ì™€ ê±°ì˜ ê°™ì€ ì½”ë“œë¼
ìƒê°í•˜ë©´ ëœë‹¤.
- ë¬¼ë¡  GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, POST Form ë°©ì‹ì„ ëª¨ë‘ ì§€ì›í•œë‹¤.

### **@RequestMapping â¡ï¸ @GetMapping, @PostMapping**

- `@RequestMapping` ì€ URLë§Œ ë§¤ì¹­í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, HTTP Methodë„ í•¨ê»˜ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ì„œ URLì´ /new-form ì´ê³ , HTTP Methodê°€ GETì¸ ê²½ìš°ë¥¼ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” ë§¤í•‘ì„ í•˜ë ¤ë©´
ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬í•˜ë©´ ëœë‹¤.

```java
  @RequestMapping(value = "/new-form", method = RequestMethod.GET)
```

- ì´ê²ƒì„ @GetMapping , @PostMapping ìœ¼ë¡œ ë” í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ì°¸ê³ ë¡œ Get, Post, Put, Delete, Patch ëª¨ë‘ ì• ë…¸í…Œì´ì…˜ì´ ì¤€ë¹„ë˜ì–´ ìˆë‹¤.
